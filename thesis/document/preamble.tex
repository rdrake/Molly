% !TEX root = Thesis.tex
\usepackage{morewrites}									% Greedy packages...
\usepackage{fontspec}									% Use nicer system fonts
%\usepackage{mathdesign}
\usepackage{graphicx}									% Pretty pictures
\usepackage{todo}										% List of things to do
\usepackage{amsmath}									% Allow use of amsthm
\usepackage{amsthm}										% Pretty theorem environments
\usepackage{amssymb}									% More math symbols
\usepackage{algorithm}									% Pretty algorithm environment
\usepackage{algorithmic}								% Pretty algorithms
\usepackage[nounderscore]{syntax}						% BNF grammars
\usepackage{minted}										% Pretty code
\usepackage{tikz}										% Diagrams
\usepackage{booktabs}									% Pretty tables
\usepackage{nag}										% Complain
\usepackage[all]{xypic}									% Easy (compared to tikz) diagrams
\usepackage{unicode-math}								% Unicode symbols in math
\usepackage{caption}									% Possible del for subcaption
\usepackage{subcaption}									% Subfigures
\usepackage{forest}										% Simple trees
\usepackage{subdepth}
\usepackage{comment}									% How is this not built-in?
\usepackage{varioref}
\usepackage[linktocpage=true,colorlinks=true]{hyperref} % Helpful links
\usepackage{cleveref}
\usepackage{datatool} % Import database tables

% Apparently must go after hyperref to get pretty links
\usepackage[acronym,style=tree]{glossaries}				% Glossary of terms

% Use and configure bibliography
\usepackage[backend=biber,style=trad-alpha]{biblatex}
\addbibresource{Thesis.bib}

% Define a new environment for Clojure code
\newmintedfile[cljcode]{clj}{linenos,frame=topline,frame=lines,framesep=2mm}
% SQL too!
\newminted{sql}{linenos,frame=topline,frame=lines,framesep=2mm}

% Configure tikz for pretty diagrams
\input tikz
\usetikzlibrary{fit}

% For some reason using minted with tikz causes minted to fail to colourize
% the output.  Should find a solution later, not really important right now.
\usemintedstyle{bw}

% Define new theorem environments
\theoremstyle{definition}
\newtheorem{defn}{Definition}
\newtheorem{ex}{Example}
\newtheorem{remark}{Remark}
\newtheorem{claim}{Claim}

% Change the image path prefix
\graphicspath{{images/}}

% Make the text worth looking at
\defaultfontfeatures{Ligatures=TeX}
\setmainfont[
	Kerning=Uppercase
]{Garamond Premier Pro}
\setmathfont{XITS Math}
\setmathfont[range=\mathbfsfit/{greek,Greek,latin,Latin}]{Garamond Premier Pro}
\setmonofont[Scale=0.9]{Consolas}

%\todo{Figure out why EB Garamond doesn't bold definitions}

% amsldoc, Section 4.14.2
\providecommand{\abs}[1]{\lvert#1\rvert}
\providecommand{\norm}[1]{\lVert#1\rVert}

% Simplify some of our function declarations
\DeclareMathOperator{\similarity}{similarity}
\DeclareMathOperator{\df}{df}
\DeclareMathOperator{\tfidf}{tf-idf}
\DeclareMathOperator{\tf}{tf}
\DeclareMathOperator{\idf}{idf}
\DeclareMathOperator{\score}{score}
\DeclareMathOperator{\freq}{freq}
\DeclareMathOperator{\query}{query}

% Expect the function name and any arguments separated by commas
\newcommand{\prop}[2]{\ensuremath\textsc{#1}\bigl[#2\bigr]}
% Expect the relation name and command-separated list of attributes
\newcommand{\rel}[2]{\ensuremath\mathrm{#1}\bigl(\mathrm{#2}\bigr)}

\newcommand{\relation}{\ensuremath r}
\newcommand{\tuple}{\ensuremath t}
\newcommand{\term}{\ensuremath \tau}
\newcommand{\field}{\ensuremath f}
\newcommand{\attribute}{\ensuremath \alpha}
\newcommand{\key}{\ensuremath \Kappa}
\newcommand{\db}{\ensuremath \mathbb{D}}
\newcommand{\doc}{\ensuremath d}
\newcommand{\dc}{\ensuremath \mathbb{C}}
\newcommand{\terms}{\ensuremath \Tau}
\newcommand{\q}{\ensuremath q}
%\newcommand{\sgraph}{\ensuremath G}
\newcommand{\egraph}{\ensuremath G}

\newcommand{\relations}[1]{\prop{Rel}{#1}}
\newcommand{\attributes}[1]{\prop{Attr}{#1}}
\newcommand{\fields}[1]{\prop{Field}{#1}}
\newcommand{\name}[1]{\prop{Name}{#1}}
\newcommand{\keys}[1]{\prop{Key}{#1}}
\newcommand{\fks}[1]{\prop{FK}{#1}}
\newcommand{\bag}[1]{\prop{Bag}{#1}}
\newcommand{\docs}[1]{\prop{Doc}{#1}}
\newcommand{\sgraph}[1]{\prop{SchemaGraph}{#1}}
\newcommand{\uid}[1]{\prop{UID}{#1}}
%\newcommand{\terms}[1]{\fcn{Term}{#1}}

% Use booktabs for datatool tables
% Stolen from SO:  http://tex.stackexchange.com/a/128581
\renewcommand{\dtldisplaystarttab}{\toprule}
\renewcommand{\dtldisplayafterhead}{\midrule}
\renewcommand{\dtldisplayendtab}{\\\bottomrule}

% Load databases
\DTLloaddb{db-link}{../../project/data/superheroes/Link.csv}
\DTLloaddb{db-person}{../../project/data/superheroes/Person.csv}
\DTLloaddb{db-superhero}{../../project/data/superheroes/Superhero.csv}
\DTLloaddb{db-planet}{../../project/data/superheroes/Planet.csv}

\newglossary{symbols}{sym}{sbl}{List of Symbols}
\makeglossaries

\includeonly{data-model,have-it-all,along-came-clojure,evaluation}