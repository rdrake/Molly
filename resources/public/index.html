<!DOCTYPE html>
<html>
	<head>
		<title>Molly :: Home</title>
		<link rel="stylesheet" type="text/css" href="/bootstrap/css/bootstrap.css">
		<style type="text/css">
html, body {
	background-color: #eee;
}

body {
	padding-top: 40px; /* 40px to make the container go all the way to the bottom of the topbar */
}

.container > footer p {
	text-align: center; /* center align it with the container */
}

.container .footer {
	margin-top: 1em;
}

.container {
	width: 820px; /* downsize our container to make the content feel a bit tighter and more cohesive. NOTE: this removes two full columns from the grid, meaning you only go to 14 columns and not 16. */
}

/* The white background content wrapper */
.container > .content {
	background-color: #fff;
	padding: 20px;
	margin: 0 -20px; /* negative indent the amount of the padding to maintain the grid system */
	-webkit-border-radius: 0 0 6px 6px;
	-moz-border-radius: 0 0 6px 6px;
	border-radius: 0 0 6px 6px;i
	-webkit-box-shadow: 0 1px 2px rgba(0,0,0,.15);
	-moz-box-shadow: 0 1px 2px rgba(0,0,0,.15);
	box-shadow: 0 1px 2px rgba(0,0,0,.15);
}

/* Page header tweaks */
.page-header {
	background-color: #f5f5f5;
	padding: 20px 20px 10px;
	margin: -20px -20px 20px;
}

.loader {
	display: none;
}
		</style>
	</head>
	<body>
		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="brand" href="/">Molly</a>
					<!--<form id="search-form" class="pull-left" action>
						<input type="search" placeholder="Search" data-provide="typeahead" class="typeahead" id="value" tabindex="1">
					</form>-->
				</div>
			</div>
		</div>
		<div class="container">
			<div class="content">
				<div class="page-header">
					<h1>Molly
						<small> Automated knowledge discovery</small>
					</h1>
				</div>
				<form id="spanning" class="form-horizontal">
					<fieldset>
						<div class="control-group">
							<label class="control-label" for="e0">e<sub>0</sub></label>
							<div class="controls">
								<input type="text" class="input-xlarge" id="e0" value="instructors|74">
								<span class="help-block">The entity to begin the search at</span>
							</div>
						</div>
						<div class="control-group">
							<label class="control-label" for="eL">e<sub>L</sub></label>
							<div class="controls">
								<input type="text" class="input-xlarge" id="eL" value="instructors|75,instructors|77">
								<span class="help-block">A comma-separated list of entities that must be in the results</span>
							</div>
						</div>
						<div class="form-actions">
							<button id="submit-btn" type="submit" class="btn btn-primary">Search</button>
							<button id="clear-btn" class="btn">Clear</button>
						</div>
					</fieldset>
				</form>
				<h3 class="loader">
					<img src="/img/ajax-loader.gif">
					Loading results...
				</h3>
				<div id="results"></div>
			</div>
		</div>
		<div class="container">
			<footer class="footer">
				<p>Built by <a href="http://me.rdrake.org/">Richard Drake</a> as a graduate research project.  Supervised by <a href="http://leda.science.uoit.ca/kenpu/">Dr. Ken Pu</a> of <a href="http://uoit.ca/">UOIT</a>.</p>
			</footer>
		</div>

		<script src="/js/jquery-1.7.1.js"></script>
		<script src="/bootstrap/js/bootstrap.js"></script>

		<script>
			var form = $("#spanning"),
				e0 = $("#e0"),
				eL = $("#eL"),
				cont = true;

			form.submit(function(e) {
				if (e0.val() == "") {
					e0.parent().parent().addClass("error");
					cont = false;
				} else {
					e0.parent().parent().removeClass("error");
					cont = true;
				}
				
				if (eL.val() == "") {
					eL.parent().parent().addClass("error");
					cont = false;
				} else {
					eL.parent().parent().removeClass("error");
					cont = true;
				}

				//
				if (cont) {
					$("#results").empty();

					$.getJSON("/span",
						{e0: e0.val(), eL: eL.val().split(",")},
						function(data) {
							$(".loader").hide();
							
							var fst = eL.val().split(",");
							var results = [];
							
							for (e in fst) {
								var result = [];
								var next = fst[e];

								do {
									result.push(next);
									next = data.prev[next];
								} while (next != e0.val());

								result.push(next);

								results.push(result);
							}

							$("#results").empty();

							for (result in results) {
								$("<p/>").append(results[result].join(" &rarr; ")).appendTo("#results");
							}
						}
					);

					$(".loader").show();
				}

				return false;
			});
		</script>

		<!--<script>
			var typeahead = $("#value");
			var form = $("#search-form");

			form.submit(function(e) {
				var val = typeahead.val();

				if (val != "") {
					$.getJSON("/entity/" + val, function(data) {
						$(".well").remove();
						$(".loader").show();

						$.each(data, function(i, val) {
							var div = $("<div/>", {
								class: "well"
							}).appendTo("#results");

							for (var propName in val) {
								if (val.hasOwnProperty(propName)) {
									div.append("<strong>" + propName +
										"</strong>: " + val[propName] + "<br>");
								}
							}
						});
					}).complete(function() {
						$(".loader").hide();
					});
				}
				
				return false;
			});
		</script>-->
	</body>
</html>
